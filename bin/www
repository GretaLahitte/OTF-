#!/usr/bin/env node

//--
require('../ressources/otf_oplog')();
//--
// Logger Configuration
var log4js = require('log4js');
log4js.configure('./ressources/log4js.json', { reloadSecs: 300 });
mongoAppender = require('log4js-node-mongodb');
log4js.addAppender(
    mongoAppender.appender({connectionString: 'localhost:27017/log'}),
    'cheese'
);

var logger = log4js.getLogger('ccs');
var loggerMongo = log4js.getLogger('mongo');
//--
var debug = require('debug')('OTF');

//--
var app = require('../app');
app.set('port', process.env.NODE_PORT || 3000);
//app.set('host', process.env.NODE_HOST || "0.0.0.0");
app.set('host', process.env.NODE_HOST || "0.0.0.0");
//
var server = app.listen(app.get('port'), app.get('host'), function () {
    logger.debug("Express server listening on http://%s:%d", app.get('host'), app.get('port'));
    loggerMongo.debug("Express server listening on http://%s:%d", app.get('host'), app.get('port'));
});
//--
// SERVER SOCKET
sio.listen(server, {log: false});
logger.debug("WebSocket Started");
//-- Middleware function


//--

