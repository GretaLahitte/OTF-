#!/usr/bin/env node

//--
//-
//--
var util = require("util");
//--
// Configuration Initialisation
//        des ANNUAIRES GLOBALS
//--
require('../ressources/otf_globals');

//--
// After INIT
//--
var log4js = require('log4js');
var logger = log4js.getLogger('www');
var loggerMongo = log4js.getLogger('mongo');
//--
if (GLOBAL.config["ENV"].modes === 'DEBUG')
    var debug = require('debug')('OTF²');
//--
// APPLICATION INITIALISATION
//--
var app = require('../app');
//
app.set('port', GLOBAL.config["LOGS"].port || process.env.NODE_PORT || 3000);
app.set('host', GLOBAL.config["LOGS"].host || process.env.NODE_HOST || "0.0.0.0");
//
var server = app.listen(app.get('port'), app.get('host'), function () {
    logger.debug("OTF² server listening on http://%s:%d", app.get('host'), app.get('port'));
    //loggerMongo.debug("OTF² server listening on http://%s:%d", app.get('host'), app.get('port'));
});
//--
// SERVER SOCKET
sio.listen(server, {log: GLOBAL.config["WEBSOCK"].log});
logger.debug("OTF² WebSocket Started");
//-- Middleware function


//--

